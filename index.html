
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <title>SW101@GDGDevFest2016 - @演说.io</title>

    <meta name="keywords" content="演说，yanshuo, yanshuo.io, 演说.io, 空中演说, 展示文稿, HTML 展示文稿, Web 展示文稿" />
  	  <meta name="description" content="创作真正跨平台的 HTML5 展示文稿，让你的分享到达世界的任何一个角落" />

  		<meta name="apple-mobile-web-app-capable" content="yes">
  		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  		<!-- Reveal base style -->
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/css/reveal.min.css">

  		<!-- Yanshuo.io seed style -->
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/atcss/at-block.min.css">
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/atcss/at-hljs-theme-bundler.min.css">
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/atcss/at-reveal-theme-bundler.min.css">

  		<!-- Source Sans Web Fonts -->
  		<link rel="stylesheet" href="https://yanshuo.io/assets/player/lib/font/source-sans-pro/source-sans-pro.css">

      <!-- Printing and PDF exports -->
      <script>
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match( /print-pdf/gi ) ? 'https://yanshuo.io/assets/player//css/print/pdf.css' : '';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      </script>

      <!--[if lt IE 9]>
  		<script src="lib/js/html5shiv.js"></script>
  		<![endif]-->

  		<!-- style for "critical path" -->
  		<style>
  	  </style>
  </head>
  <body>
    <!-- TODO: a lightweighted loading -->

    <!-- main slides -->
    <div id="YS" class="at-code-lh-15" style="width:100%;height:100%;" data-reveal-theme="qcon" data-highlight-theme="androidstudio" data-ys-title="SW101@GDGDevFest2016" data-ys-user="黄玄" data-ys-transition="none" data-ys-backgroundTransition="none" data-ys-transitionSpeed="default"><div class="reveal"><div class="slides"><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:13px;top:207px;width:950px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h1 style="text-align:left"><strong>Service Worker 101</strong></h1></article></div><div style="left:15px;top:319px;width:911.9061488673138px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>Working Offline&nbsp;and&nbsp;Instant Loading </strong></h3></article></div><div style="left:19.588996763754047px;top:543.3559870550162px;width:192px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p style="text-align:left"><span style="font-size:28px"><a href="http://huangxuan.me">黄玄/@huxpro</a></span></p></article></div><div style="left:19.88349514563107px;top:578.1779935275081px;width:324px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p style="text-align:left"><span style="font-size:20px">@GDG DevFest Beijing&nbsp;Nov&nbsp;2016</span></p></article></div><div style="left:21.042071197410998px;top:631.4724919093851px;width:188.99676375404533px;height:36px;" class="at-block at-block--pure"><article class="at-block-content"><iframe src='https://ghbtns.com/github-btn.html?user=huxpro&type=follow&count=true' data-prevent-swipe allowfullscreen></iframe></article></div><div style="width:348.99177552007745px;height:90.7378616352201px;left:160.0503927490555px;top:94.48346596148771px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/devfest-logo.png /></article></div><div style="width:113.39832285115307px;height:90.7580326985791px;left:19.978575331570426px;top:92.06724837885433px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/pwars-logo.png /></article></div><div style="left:780px;top:306px;width:100px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p style="text-align:left"><span style="font-size:72px">⚡️</span></p></article></div><div style="width:179px;height:179px;left:751px;top:475px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/qrcode.png /></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:100px;top:67px;width:777.4229962909208px;height:582.1596516690856px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>{
  <span class="hljs-attr">"name"</span>: [<span class="hljs-string">"黄玄"</span>, <span class="hljs-string">"Hux"</span>, <span class="hljs-string">"@huxpro"</span>],
  <span class="hljs-attr">"icons"</span>: [{










   }],
  <span class="hljs-attr">"start_url"</span>: <span class="hljs-string">"            "</span>,
  <span class="hljs-attr">"social_network"</span>: [<span class="hljs-string">"     "</span>, <span class="hljs-string">"      "</span>, <span class="hljs-string">"    "</span>],
  <span class="hljs-attr">"work_experience"</span>: [<span class="hljs-string">"@alibaba"</span>, <span class="hljs-string">"@wepiao"</span>]
}
</code></pre>
</article></div><div style="left:-0.7926140945008768px;top:166px;width:958.0390259635543px;height:337px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><p><img style="border-radius: 50%; width:290px" src="https://huangxuan.me/img/avatar-hux.jpg"/></p>
</article></div><div style="left:391.2330097087378px;top:534.7864077669902px;width:416.1067961165047px;height:auto0000;" class="at-block at-block--pure"><article class="at-block-content"><p style="text-align:left"><span style="font-size:24px"><a href="http://weibo.com/huxpro">Weibo</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="https://github.com/huxpro">GitHub</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://www.zhihu.com/people/huxpro">知乎</a></span></p></article></div><div style="left:316.2330097087378px;top:502.78640776699024px;width:241.1067961165047px;height:auto0000000;" class="at-block at-block--pure"><article class="at-block-content"><p style="text-align:left"><span style="font-size:24px"><a href="https://huangxuan.me">huangxuan.me</a></span></p></article></div></section><section data-notes="" data-background-image="https://huangxuan.me/sw-101-gdgdf/attach/cinema-online.jpg" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"></section><section data-notes="" data-background-image="https://huangxuan.me/sw-101-gdgdf/attach/cinema-offline.jpg" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(0, 0, 0, 1)" data-transition="none"><div style="width:960px;height:712.258064516129px;left:-1px;top:-6.12903225806452px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/lie-fi.jpg /></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:16px;top:167px;width:882px;height:auto00000000000000000000;" class="at-block at-block--pure"><article class="at-block-content"><h2 style="text-align:left"><strong>Web is&nbsp;constructed&nbsp;with the assumption that you have put yourself&nbsp;into the "internet mode"</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:256.875px;height:411px;left:24.743729773462803px;top:143.88349514563106px;" class="at-block at-block--pure"><article class="at-block-content"><img src=http://huangxuan.me/pwa-in-my-pov/attach/airhornor.png /></article></div><div style="width:128px;height:128px;left:767px;top:238px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/icon_network.png /></article></div><div style="left:265px;top:246px;width:479px;height:auto00000;" class="at-block at-block--pure"><article class="at-block-content"><h1><span style="color:#000000">⟵ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;⟶</span></h1></article></div><div style="left:629px;top:368px;width:399px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p><strong><span style="font-size:24px">Network</span></strong></p></article></div><div style="left:105px;top:273px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>HTTP</strong></h3></article></div><div style="left:26px;top:204px;width:959px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p>Download &amp; Run on the fly</p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:20px;top:227px;width:1187.9741100323624px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left">&nbsp;</h3><h1 style="text-align:left"><strong>Working Offline?</strong></h1><p style="text-align:left">&nbsp;</p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:60px;width:800px;height:569px;" class="at-block at-block--pure"><article class="at-block-content"><iframe src='https://www.w3.org/TR/offline-webapps/' data-prevent-swipe allowfullscreen></iframe></article></div><div style="left:79px;top:641px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:22px"><a href="https://www.w3.org/TR/offline-webapps/">https://www.w3.org/TR/offline-webapps/</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:42.36601201649745px;top:61.10623095089113px;width:876px;height:auto;" class="at-block at-block--pure"><article class="at-block-content"><h2><strong>App&nbsp;Cache</strong></h2></article></div><div style="left:105.87040887040887px;top:246.982674982675px;width:761.1919611919611px;height:59.80595980595979px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code class="lang-html">&lt;<span class="hljs-selector-tag">html</span> manifest=<span class="hljs-string">"cache.appcache"</span>&gt;
</code></pre>
</article></div><div style="left:79px;top:158px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><a href="https://www.w3.org/TR/2011/WD-html5-20110525/offline.html"><strong>HTML5 Offline Web Applications (2011)</strong></a></p></article></div><div style="left:105.87040887040887px;top:327.982674982675px;width:761.1919611919611px;height:342.8059598059598px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="hljs-built_in">CACHE</span> MANIFEST

<span class="hljs-built_in">CACHE</span>:
style/<span class="hljs-keyword">default</span>.css
images/sound-icon.png
images/background.png

NETWORK:
comm.cgi
</code></pre>
</article></div></section><section data-notes="" data-background-image="https://huangxuan.me/pwa-qcon2016/attach/jake-appcache.jpg" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:55.51456310679613px;top:642.2944983818771px;width:828.4563106796116px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p><a href="http://alistapart.com/article/application-cache-is-a-douchebag"><span style="font-size:24px">http://alistapart.com/article/application-cache-is-a-douchebag</span></a></p></article></div></section><section data-notes="" data-background-image="https://huangxuan.me/pwa-qcon2016/attach/jake-appcache.jpg" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:55.51456310679613px;top:642.2944983818771px;width:828.4563106796116px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p><a href="http://alistapart.com/article/application-cache-is-a-douchebag"><span style="font-size:24px">http://alistapart.com/article/application-cache-is-a-douchebag</span></a></p></article></div><div style="left:26px;top:34px;width:885px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p><em><span style="color:#FFFFFF">HTTP caching Race Condition</span></em></p><p><em><span style="color:#FFFFFF"><strong>Unrecoverable Errors</strong> (Cache the manifest)</span></em></p><p><em><span style="color:#FFFFFF">Success only If ALL&nbsp;resources are cached</span></em></p><p><em><span style="color:#FFFFFF">Not a Progressive Enhancement</span></em></p><p><em><span style="color:#FFFFFF">Caching Dynamic Contents needs&nbsp;hack &amp; re-architecture</span></em></p><p><em><span style="color:#FFFFFF">Full of Assumption</span></em></p><p><em><span style="color:#FFFFFF">The Cache is organized by "Manifest"</span></em></p><p><em><span style="color:#FFFFFF">Manifest changes trigger&nbsp;<strong>ALL</strong> cached files redownload.</span></em></p><p><em><span style="color:#FFFFFF">NO clean up mechanism for cache</span></em></p><p><em><span style="color:#FFFFFF">Deficit of Flexibility</span></em></p><p><em><span style="color:#FFFFFF">Unprogrammable</span></em></p><p><em><span style="color:#FFFFFF">Very Limited Fallback/Routing</span></em></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:960px;height:621px;left:0;top:39.5px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/appcache-remove.png /></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:20px;top:227px;width:1187.9741100323624px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left">&nbsp;</h3><h1 style="text-align:left"><strong>Instant Loading?</strong></h1><p style="text-align:left">&nbsp;</p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:256.875px;height:411px;left:24.743729773462803px;top:143.88349514563106px;" class="at-block at-block--pure"><article class="at-block-content"><img src=http://huangxuan.me/pwa-in-my-pov/attach/airhornor.png /></article></div><div style="width:128px;height:128px;left:767px;top:238px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/icon_network.png /></article></div><div style="left:265px;top:246px;width:479px;height:auto00000;" class="at-block at-block--pure"><article class="at-block-content"><h1><span style="color:#000000">⟵ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;⟶</span></h1></article></div><div style="left:629px;top:368px;width:399px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p><strong><span style="font-size:24px">Network</span></strong></p></article></div><div style="left:105px;top:273px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>HTTP</strong></h3></article></div><div style="left:28px;top:195px;width:959px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p>Round Trip is Expensive</p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:825.3333333333334px;height:619px;left:67.33333333333331px;top:0;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/timeline-huxblog.jpg /></article></div><div style="left:0;top:637px;width:958px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p>Dependency Graph</p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:256.875px;height:411px;left:24.743729773462803px;top:143.88349514563106px;" class="at-block at-block--pure"><article class="at-block-content"><img src=http://huangxuan.me/pwa-in-my-pov/attach/airhornor.png /></article></div><div style="width:128px;height:128px;left:767px;top:238px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/icon_network.png /></article></div><div style="left:265px;top:246px;width:479px;height:auto00000;" class="at-block at-block--pure"><article class="at-block-content"><h1><span style="color:#000000">⟵ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;⟶</span></h1></article></div><div style="left:629px;top:368px;width:399px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p><strong><span style="font-size:24px">Network</span></strong></p></article></div><div style="left:105px;top:273px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>HTTP</strong></h3></article></div><div style="left:105px;top:178px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>HTTP Caching</strong></h3></article></div><div style="left:105px;top:370px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong><a href="https://www.chromium.org/spdy/spdy-whitepaper">SPDY</a>&nbsp;</strong></h3><h3><a href="https://http2.github.io/"><strong>HTTP/2</strong></a></h3><h3><strong><a href="https://w3c.github.io/preload/">rel=Preload</a></strong></h3><p>&nbsp;</p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:20px;top:227px;width:1187.9741100323624px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>Mobile is HARD&nbsp;due to its flaky network</strong></h3><h1 style="text-align:left"><span style="color:#F44E3B"><strong>INSUFFICIENT!</strong></span></h1><p style="text-align:left">&nbsp;</p></article></div></section><section data-notes="" data-background-image="https://huangxuan.me/pwa-qcon2016/attach/service-worker-jake.jpg" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:0.1288501854539561px;top:138.593936461861px;width:958px;height:411.977422996291px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><p><video controls preload src="https://huangxuan.me/sw-101-gdgdf/attach/videos/intro-sw.mp4"><video/></p>
</article></div><div style="left:79px;top:645px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:22px"><a href="https://youtu.be/QiXLaisCq10">https://youtu.be/QiXLaisCq10</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:79px;top:60px;width:800px;height:547.652152878568px;" class="at-block at-block--pure"><article class="at-block-content"><iframe src='https://www.w3.org/TR/service-workers/' data-prevent-swipe allowfullscreen></iframe></article></div><div style="left:66.61490082244799px;top:639.5452346395742px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:22px"><a href="https://www.w3.org/TR/service-workers/">https://www.w3.org/TR/service-workers/</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:82px;top:40px;width:800px;height:600px;" class="at-block at-block--pure"><article class="at-block-content"><iframe src='https://jakearchibald.github.io/isserviceworkerready/' data-prevent-swipe allowfullscreen></iframe></article></div><div style="left:81px;top:646px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:22px"><a href="https://jakearchibald.github.io/isserviceworkerready/">https://jakearchibald.github.io/isserviceworkerready/</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:256.875px;height:411px;left:24.743729773462803px;top:143.88349514563106px;" class="at-block at-block--pure"><article class="at-block-content"><img src=http://huangxuan.me/pwa-in-my-pov/attach/airhornor.png /></article></div><div style="width:128px;height:128px;left:767px;top:238px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/icon_network.png /></article></div><div style="width:128px;height:128px;left:440px;top:237px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/icon_sw.png /></article></div><div style="width:128px;height:128px;left:444px;top:487px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/icon_cache.png /></article></div><div style="left:265px;top:246px;width:479px;height:auto00000;" class="at-block at-block--pure"><article class="at-block-content"><h1><span style="color:#000000">⟷ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;⟷</span></h1></article></div><div style="left:436px;top:388px;width:143px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h1><span style="color:#000000">↕︎</span></h1></article></div><div style="left:304px;top:183px;width:407px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p><strong><span style="font-size:24px">Service Worker</span></strong></p></article></div><div style="left:309px;top:602px;width:407px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p><strong><span style="font-size:24px">Cache</span></strong></p></article></div><div style="left:629px;top:368px;width:399px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p><strong><span style="font-size:24px">Network</span></strong></p></article></div><div style="left:88px;top:45px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h4><strong>Client-side Proxy</strong></h4></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Live Coding #1</strong></h3><h2 style="text-align:left"><strong>"Hello World" of SW!</strong></h2></article></div></section><section data-notes="" data-background-image="https://huangxuan.me/pwa-qcon2016/attach/test-failed.gif" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:-3px;top:591px;width:959px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h2><strong><span style="color:#FFFFFF">"Living Coding"</span></strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:78.70550161812297px;top:251.98381877022655px;width:800px;height:333.3527508090615px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="hljs-comment">// register Service Worker in index.html</span>
<span class="hljs-selector-tag">if</span>(<span class="hljs-string">'serviceWorker'</span> in navigator) {
  <span class="hljs-selector-tag">navigator</span><span class="hljs-selector-class">.serviceWorker</span>
    <span class="hljs-selector-class">.register</span>(<span class="hljs-string">'/sw.js'</span>)
    <span class="hljs-selector-class">.then</span>( registration =&gt; {
      console<span class="hljs-selector-class">.log</span>(<span class="hljs-string">'Service Worker Registered'</span>);
    })<span class="hljs-selector-class">.catch</span>( error =&gt; {
      console<span class="hljs-selector-class">.log</span>(<span class="hljs-string">'Registration failed with'</span> + error);
    })
}
</code></pre>
</article></div><div style="left:76.41100323624595px;top:148.80258899676375px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>Register</strong></h3></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(35, 102, 170, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Gotcha #0</strong></h3><h2 style="text-align:left"><strong>HTTPS as Prerequisite</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:56px;top:632px;width:844px;height:auto;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:24px"><a href="https://blog.chromium.org/2016/09/moving-towards-more-secure-web.html">Moving Towards a More Secure Web - Chromium&nbsp;Blog</a></span></p></article></div><div style="width:606.32735118172px;height:237.60453074433656px;left:177.425321172894px;top:135.56990291262133px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/pwa-qcon2016/attach/chrome-https-1.png /></article></div><div style="width:418.9506226444588px;height:203.29288025889971px;left:270.5246886777706px;top:388.92475728155335px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/pwa-qcon2016/attach/chrome-https-2.png /></article></div><div style="left:95.82847896440128px;top:55.59870550161812px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>Stay Secure</strong></h3></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:78.70550161812297px;top:251.98381877022655px;width:800px;height:333.3527508090615px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="hljs-comment">/* sw.js */</span>
self.onfetch = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  e.respondWith(<span class="hljs-keyword">new</span> Response(<span class="hljs-string">'Hello World from SW!'</span>))
}
</code></pre>
</article></div><div style="left:77.41100323624595px;top:148.80258899676375px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>Say "Hello World"</strong></h3></article></div><div style="left:2px;top:487px;width:955px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h1>😱😱😱</h1></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:256.875px;height:411px;left:24.743729773462803px;top:143.88349514563106px;" class="at-block at-block--pure"><article class="at-block-content"><img src=http://huangxuan.me/pwa-in-my-pov/attach/airhornor.png /></article></div><div style="width:128px;height:128px;left:767px;top:238px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/icon_network.png /></article></div><div style="width:128px;height:128px;left:440px;top:237px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/icon_sw.png /></article></div><div style="width:128px;height:128px;left:444px;top:487px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/icon_cache.png /></article></div><div style="left:265px;top:246px;width:479px;height:auto00000;" class="at-block at-block--pure"><article class="at-block-content"><h1><span style="color:#000000">⟷ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;⟷</span></h1></article></div><div style="left:436px;top:388px;width:143px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h1><span style="color:#000000">↕︎</span></h1></article></div><div style="left:304px;top:183px;width:407px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p><strong><span style="font-size:24px">Service Worker</span></strong></p></article></div><div style="left:309px;top:602px;width:407px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><p><strong><span style="font-size:24px">Cache</span></strong></p></article></div><div style="left:629px;top:368px;width:399px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p><strong><span style="font-size:24px">Network</span></strong></p></article></div><div style="left:88px;top:45px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h4><strong>How can SW be started <span style="color:#F44E3B">before</span> </strong></h4><h4><strong>navigations occur?</strong></h4></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(35, 102, 170, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Gotcha #1</strong></h3><h2 style="text-align:left"><strong>SW is a&nbsp;Web Worker</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:78.70550161812297px;top:250.98381877022655px;width:800px;height:362.3527508090615px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>[SecureContext, Exposed=(Window,Worker)]
<span class="hljs-keyword">interface</span> <span class="hljs-title">ServiceWorker</span> : <span class="hljs-title">EventTarget</span> {
  <span class="hljs-keyword">readonly</span> attribute USVString scriptURL;
  <span class="hljs-keyword">readonly</span> attribute ServiceWorkerState state;
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">postMessage</span>(<span class="hljs-params">any message, optional sequence&lt;<span class="hljs-keyword">object</span>&gt; transfer = []</span>)</span>;

  <span class="hljs-comment">// event</span>
  attribute EventHandler onstatechange;
};
ServiceWorker implements AbstractWorker;
</code></pre>
</article></div><div style="left:76.41100323624595px;top:148.80258899676375px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>WD 3.1 ServiceWorker</strong></h3></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:81.61488673139158px;top:154.34304207119743px;width:794.4336569579289px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><ul><li><h3 style="text-align: left;"><strong>Web Workers</strong></h3></li><li><h3 style="text-align: left;"><strong>SharedWorker&nbsp;</strong></h3></li><li><h3><strong>Chrome Background Pages</strong></h3></li><li><h3><strong>Chrome Event Pages</strong></h3></li><li><h3><strong>!App Cache</strong></h3></li></ul></article></div><div style="left:61.53398058252425px;top:608.294498381877px;width:807px;height:auto0000;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:28px">&nbsp;<a href="https://w3c.github.io/ServiceWorker/#motivations">https://w3c.github.io/ServiceWorker/#motivations</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:81.61488673139158px;top:154.34304207119743px;width:794.4336569579289px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><ul><li><h3 style="text-align:left"><strong>Web Workers</strong></h3></li><li><h3 style="text-align:left"><strong><span style="color:#F44E3B">Shared</span>Worker&nbsp;</strong></h3></li><li><h3><strong>Chrome <span style="color:#F44E3B">Background</span> Pages</strong></h3></li><li><h3><strong>Chrome <span style="color:#F44E3B">Event</span>&nbsp;Pages</strong></h3></li><li><h3><strong><span style="color:#F44E3B">!</span>App Cache</strong></h3></li></ul></article></div><div style="left:61.53398058252425px;top:608.294498381877px;width:807px;height:auto0000;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:28px">&nbsp;<a href="https://w3c.github.io/ServiceWorker/#motivations">https://w3c.github.io/ServiceWorker/#motivations</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:81.61488673139158px;top:154.34304207119743px;width:794.4336569579289px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><ul><li><h3 style="text-align:left"><strong>Entirely Async</strong></h3></li><li><h3 style="text-align:left"><strong><span style="color:#F44E3B">Shared across browsing context</span>&nbsp;</strong></h3></li><li><h3><span style="color:#F44E3B"><strong>Persistent&nbsp;Background Processing</strong></span></h3></li><li><h3><strong><span style="color:#F44E3B">Event-Driven, Time-Limited</span></strong></h3></li><li><h3><strong>Programmable</strong></h3></li></ul></article></div><div style="left:61.53398058252425px;top:608.294498381877px;width:807px;height:auto0000;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:28px">&nbsp;<a href="https://w3c.github.io/ServiceWorker/#motivations">https://w3c.github.io/ServiceWorker/#motivations</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(35, 102, 170, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:968.9741100323624px;height:auto0000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Gotcha #2</strong></h3><h2 style="text-align:left"><strong>be Started and Killed Anytime</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:435.6343042071197px;top:448.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><span style="font-size:48px">⤡</span></h3></article></div><div style="left:432.6343042071197px;top:118.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:295.6343042071197px;top:213.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>⤹</strong></h3></article></div><div style="left:369px;top:51px;width:230px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Register</div></article></div><div style="left:370px;top:175px;width:249px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Install</div></article></div><div style="left:520px;top:273px;width:235px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Error</div></article></div><div style="left:519px;top:500px;width:219px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Terminated</div></article></div><div style="left:216px;top:388px;width:225px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Idle</div></article></div><div style="left:219px;top:275px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Activated</div></article></div><div style="left:216px;top:500px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Active</div></article></div><div style="left:283.6343042071197px;top:337.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:283.6343042071197px;top:450.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:573.6343042071197px;top:219.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h5>⤵︎</h5></article></div><div style="left:-2px;top:632px;width:961px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h4><a href="http://www.html5rocks.com/en/tutorials/service-worker/introduction/">Service Worker LifeCycle</a></h4></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:435.6343042071197px;top:448.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><span style="font-size:48px">⤡</span></h3></article></div><div style="left:432.6343042071197px;top:118.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:295.6343042071197px;top:213.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>⤹</strong></h3></article></div><div style="left:369px;top:51px;width:230px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Register</div></article></div><div style="left:370px;top:175px;width:249px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Install</div></article></div><div style="left:520px;top:273px;width:235px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Error</div></article></div><div style="left:519px;top:500px;width:219px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Terminated</div></article></div><div style="left:216px;top:388px;width:225px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Idle</div></article></div><div style="left:219px;top:275px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Activated</div></article></div><div style="left:216px;top:500px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Active</div></article></div><div style="left:283.6343042071197px;top:337.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:283.6343042071197px;top:450.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:573.6343042071197px;top:219.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h5>⤵︎</h5></article></div><div style="left:-2px;top:632px;width:961px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h4>LifeCycle Events</h4></article></div><div style="left:326px;top:134px;width:92px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h1>⏱</h1></article></div><div style="left:163px;top:232px;width:92px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h1>⏱</h1></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:435.6343042071197px;top:448.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><span style="font-size:48px">⤡</span></h3></article></div><div style="left:432.6343042071197px;top:118.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:295.6343042071197px;top:213.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>⤹</strong></h3></article></div><div style="left:369px;top:51px;width:230px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Register</div></article></div><div style="left:370px;top:175px;width:249px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Install</div></article></div><div style="left:520px;top:273px;width:235px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Error</div></article></div><div style="left:519px;top:500px;width:219px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Terminated</div></article></div><div style="left:216px;top:388px;width:225px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Idle</div></article></div><div style="left:219px;top:275px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Activated</div></article></div><div style="left:216px;top:500px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Active</div></article></div><div style="left:283.6343042071197px;top:337.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:283.6343042071197px;top:450.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:573.6343042071197px;top:219.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h5>⤵︎</h5></article></div><div style="left:-2px;top:632px;width:961px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h4>Functional&nbsp;Events</h4></article></div><div style="left:18px;top:418px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #2366AA; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Fetch</div></article></div><div style="left:45px;top:490px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #2366AA; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Push</div></article></div><div style="left:69px;top:562px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #2366AA; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Sync</div></article></div><div style="left:5px;top:391px;width:92px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h2>&nbsp;</h2><h2>⚙</h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:435.6343042071197px;top:448.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><span style="font-size:48px">⤡</span></h3></article></div><div style="left:432.6343042071197px;top:118.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:295.6343042071197px;top:213.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>⤹</strong></h3></article></div><div style="left:369px;top:51px;width:230px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #2366AA; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Register</div></article></div><div style="left:370px;top:175px;width:249px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #2366AA; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Install</div></article></div><div style="left:520px;top:273px;width:235px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Error</div></article></div><div style="left:519px;top:500px;width:219px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Terminated</div></article></div><div style="left:216px;top:388px;width:225px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Idle</div></article></div><div style="left:219px;top:275px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Activated</div></article></div><div style="left:216px;top:500px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Active</div></article></div><div style="left:283.6343042071197px;top:337.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:283.6343042071197px;top:450.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:573.6343042071197px;top:219.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h5>⤵︎</h5></article></div><div style="left:-2px;top:632px;width:961px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h4>Registered =&gt; fire "Install"&nbsp;</h4></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:435.6343042071197px;top:448.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><span style="font-size:48px">⤡</span></h3></article></div><div style="left:432.6343042071197px;top:118.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:295.6343042071197px;top:213.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>⤹</strong></h3></article></div><div style="left:369px;top:51px;width:230px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #2366AA; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Register</div></article></div><div style="left:370px;top:175px;width:249px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #2366AA; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Install</div></article></div><div style="left:520px;top:273px;width:235px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Error</div></article></div><div style="left:519px;top:500px;width:219px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: red; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Terminated</div></article></div><div style="left:216px;top:388px;width:225px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: rgb(40, 43, 46); width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Idle</div></article></div><div style="left:219px;top:275px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Activated</div></article></div><div style="left:216px;top:500px;width:232px;height:71.92712550607288px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><div style="background: #249F5A; width: 220px; height: 60px; border-radius: 10px;line-height: 60px; color: white">Active</div></article></div><div style="left:283.6343042071197px;top:337.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:283.6343042071197px;top:450.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3>↕︎</h3></article></div><div style="left:573.6343042071197px;top:219.4724919093851px;width:88px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h5>⤵︎</h5></article></div><div style="left:-2px;top:632px;width:961px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h4>The Real Installability!</h4></article></div><div style="left:326px;top:147px;width:83px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h1>✨</h1></article></div><div style="left:545px;top:185px;width:83px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h2>✨</h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:91.53398058252426px;top:212.8414239482201px;width:800px;height:364.3306873460747px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="hljs-comment">// sw.js</span>
self.oninstall = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  e.waitUntil(
    caches.open(<span class="hljs-string">'installation'</span>)
      .then(<span class="hljs-function"><span class="hljs-params">cache</span> =&gt;</span>  cache.addAll([
        <span class="hljs-string">'/styles.css'</span>,
        <span class="hljs-string">'/script.js'</span>
      ]))
  )
});
</code></pre>
</article></div><div style="left:74.58899676375404px;top:110.77669902912623px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>On Install</strong></h3></article></div><div style="left:-1px;top:567px;width:955px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h1>😱😱😱</h1></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(35, 102, 170, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Gotcha #3</strong></h3><h2 style="text-align:left"><strong>Scriptable&nbsp;</strong><strong>File-Level Install</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Live Coding #2</strong></h3><h2 style="text-align:left"><strong>Make Your Own Dinosaurs!</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:83.76699029126213px;top:291.6828478964402px;width:800px;height:342.68284789644014px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>self.onfetch = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> fetched = fetch(e.request)
  <span class="hljs-keyword">const</span> cached = caches.match(e.request)
  <span class="hljs-keyword">const</span> sorry = caches.match(<span class="hljs-string">'offline.html'</span>)

  e.respondWith(
    fetched.catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> cached).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res || sorry)
  )
}
</code></pre>
</article></div><div style="left:79.76699029126213px;top:164.85113268608416px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>Network falling to Cache/Sorry</strong></h3></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:84.12885018545396px;top:66.59393646186099px;width:800px;height:521.977422996291px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><p><video autoplay loop src="https://huangxuan.me/sw-101-gdgdf/attach/videos/network-falling-back-to-cache.m4v"><video/></p>
</article></div><div style="left:72.22689888727625px;top:600.4533139816158px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><strong>Network First (not ideal)</strong></p><p><span style="font-size:22px"><a href="https://jakearchibald.com/2014/offline-cookbook/">©https://jakearchibald.com/2014/offline-cookbook/</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:83.76699029126213px;top:180.6828478964402px;width:800px;height:445.8122977346278px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>self.onfetch = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-comment">// chrome would disk-cache any res with no 'cache-control',</span>
  <span class="hljs-comment">// which broke the assumption here we want </span>
  <span class="hljs-comment">// fetching index.html failed on offline</span>
  <span class="hljs-keyword">const</span> fetched = fetch(<span class="hljs-string">`<span class="hljs-subst">${e.request.url}</span>?<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>)
  <span class="hljs-comment">// but would also break revalidation depends on your CDN </span>
  <span class="hljs-keyword">const</span> cached = caches.match(e.request)
  <span class="hljs-keyword">const</span> sorry = caches.match(<span class="hljs-string">'offline.html'</span>)

  e.respondWith(
    fetched.catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> cached).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res || sorry)
  )
}
</code></pre>
</article></div><div style="left:76.47249190938511px;top:73.89967637540454px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>cache: 'no-cache' workaround&nbsp;&nbsp;</strong></h3></article></div><div style="left:76.22689888727625px;top:642.4533139816158px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:22px"><a href="https://jakearchibald.com/2016/caching-best-practices/">https://jakearchibald.com/2016/caching-best-practices/</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:95.53398058252426px;top:154.8414239482201px;width:800px;height:155.24007245934337px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="hljs-keyword">interface</span> <span class="hljs-title">ExtendableEvent</span> : <span class="hljs-title">Event</span> {
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">waitUntil</span>(<span class="hljs-params">Promise&lt;any&gt; f</span>)</span>;
};
</code></pre>
</article></div><div style="left:81.58899676375404px;top:60.77669902912622px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>WD 4.4&nbsp;ExtendableEvent</strong></h3></article></div><div style="left:82.52750809061489px;top:346.50485436893206px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>WD 4.6 FetchEvent</strong></h3></article></div><div style="left:90px;top:447.042071197411px;width:800px;height:207.02000773442427px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code><span class="hljs-keyword">interface</span> <span class="hljs-title">FetchEvent</span> : <span class="hljs-title">ExtendableEvent</span> {
  [SameObject] <span class="hljs-keyword">readonly</span> attribute Request request;
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">respondWith</span>(<span class="hljs-params">Promise&lt;Response&gt; r</span>)</span>;
};
</code></pre>
</article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:80.12885018545396px;top:27.59393646186099px;width:800px;height:639.977422996291px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><p><video     autoplay loop src="https://huangxuan.me/pwa-qcon2016/attach/sw-install.mp4"><video/></p>
</article></div><div style="left:72.22689888727625px;top:605.4533139816158px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p>The First Service Worker</p><p><a href="https://developers.google.com/web/fundamentals/instant-and-offline/service-worker/lifecycle"><span style="font-size:18px">https://developers.google.com/web/fundamentals/instant-and-offline/service-worker/lifecycle</span></a></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(35, 102, 170, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Gotcha #4</strong></h3><h2 style="text-align:left"><strong>SW is for SECOND Load</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:72.53398058252426px;top:267.8414239482201px;width:800px;height:180.24007245934337px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>[Exposed=ServiceWorker]
<span class="hljs-keyword">interface</span> <span class="hljs-title">Clients</span> {
  <span class="hljs-comment">// Jake: take control of uncontrolled clients</span>
  [NewObject] <span class="hljs-function">Promise&lt;<span class="hljs-keyword">void</span>&gt; <span class="hljs-title">claim</span>(<span class="hljs-params"></span>)</span>;
};
</code></pre>
</article></div><div style="left:83.58899676375404px;top:168.77669902912623px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>WD 4.3.4 claim()</strong></h3></article></div><div style="left:78px;top:506px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p>Override Default (Racing)</p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Live Coding #3</strong></h3><h2 style="text-align:left"><strong>Stale While Revalidate</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:84.12885018545396px;top:66.59393646186099px;width:800px;height:521.977422996291px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><p><video autoplay loop src="https://huangxuan.me/sw-101-gdgdf/attach/videos/cache-falling-back-to-network.m4v"><video/></p>
</article></div><div style="left:72.22689888727625px;top:600.4533139816158px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><strong>Cache First</strong></p><p><span style="font-size:22px"><a href="https://jakearchibald.com/2014/offline-cookbook/">©https://jakearchibald.com/2014/offline-cookbook/</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:84.12885018545396px;top:66.59393646186099px;width:800px;height:521.977422996291px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><p><video autoplay loop src="https://huangxuan.me/sw-101-gdgdf/attach/videos/generic-fallback.m4v"><video/></p>
</article></div><div style="left:72.22689888727625px;top:600.4533139816158px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><strong>Generic Fallback</strong></p><p><span style="font-size:22px"><a href="https://jakearchibald.com/2014/offline-cookbook/">©https://jakearchibald.com/2014/offline-cookbook/</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:87.76699029126213px;top:115.68284789644017px;width:800px;height:570.6828478964401px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>self.onfetch = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> cached = caches.match(e.request)
  <span class="hljs-keyword">const</span> fallback = caches.match(<span class="hljs-string">'offline.html'</span>)
  <span class="hljs-keyword">const</span> fetched = fetch(<span class="hljs-string">`<span class="hljs-subst">${e.request.url}</span>?<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>)


  e.respondWith(
    cached
      .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res || fetched)
      .catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> fallback)
  )
}
</code></pre>
</article></div><div style="left:78.76699029126213px;top:37.85113268608414px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>Cache-First (Stale)&nbsp;<span style="color:#999999">&amp;</span> Fallback</strong></h3></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:84.12885018545396px;top:66.59393646186099px;width:800px;height:521.977422996291px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><p><video autoplay loop src="https://huangxuan.me/sw-101-gdgdf/attach/videos/cache-and-network-race.m4v"><video/></p>
</article></div><div style="left:72.22689888727625px;top:600.4533139816158px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><strong>Cache and&nbsp;Network Race (Fastest)</strong></p><p><span style="font-size:22px"><a href="https://jakearchibald.com/2014/offline-cookbook/">©https://jakearchibald.com/2014/offline-cookbook/</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:87.76699029126213px;top:115.68284789644017px;width:800px;height:570.6828478964401px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>self.onfetch = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> cached = caches.match(e.request)
  <span class="hljs-keyword">const</span> fallback = caches.match(<span class="hljs-string">'offline.html'</span>)
  <span class="hljs-keyword">const</span> fetched = fetch(<span class="hljs-string">`<span class="hljs-subst">${e.request.url}</span>?<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>)


  e.respondWith(
    <span class="hljs-built_in">Promise</span>.race([fetched.catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> cached), cached])
      .then(<span class="hljs-function"><span class="hljs-params">resp</span> =&gt;</span> resp || fetched)
      .catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> fallback)
  )
}
</code></pre>
</article></div><div style="left:78.76699029126213px;top:37.85113268608414px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>Fastest&nbsp;<span style="color:#999999">&amp;</span> Fallback</strong></h3></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:72.22689888727625px;top:600.4533139816158px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><strong>Stale While Revalidate</strong></p><p><span style="font-size:22px"><a href="https://jakearchibald.com/2014/offline-cookbook/">©https://jakearchibald.com/2014/offline-cookbook/</a></span></p></article></div><div style="width:700px;height:354px;left:122px;top:125px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/videos/stale-while-revalidate.png /></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:87.76699029126213px;top:115.68284789644017px;width:800px;height:570.6828478964401px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>self.onfetch = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> cached = caches.match(e.request)
  <span class="hljs-keyword">const</span> fallback = caches.match(<span class="hljs-string">'offline.html'</span>)
  <span class="hljs-keyword">const</span> fetched = fetch(<span class="hljs-string">`<span class="hljs-subst">${e.request.url}</span>?<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>)
  <span class="hljs-keyword">const</span> fetchedCopy = fetched.then(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> _.clone())

  e.respondWith(
    cached
      .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res || fetched)
      .catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> fallback)
  )

  e.waitUntil(
    <span class="hljs-built_in">Promise</span>.all([fetchedCopy, caches.open(<span class="hljs-string">'runtime'</span>)])
      .then(<span class="hljs-function">(<span class="hljs-params">[resp, cache]</span>) =&gt;</span> resp.ok &amp;&amp; cache.put(e.request, resp))
      .catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> {<span class="hljs-comment">/* swallow */</span>})
  )
}
</code></pre>
</article></div><div style="left:78.76699029126213px;top:37.85113268608414px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>Stale-W-Revalidate&nbsp;<span style="color:#999999">&amp;</span> Fallback</strong></h3></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:87.76699029126213px;top:115.68284789644017px;width:800px;height:570.6828478964401px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>self.onfetch = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> cached = caches.match(e.request)
  <span class="hljs-keyword">const</span> fallback = caches.match(<span class="hljs-string">'offline.html'</span>)
  <span class="hljs-keyword">const</span> fetched = fetch(<span class="hljs-string">`<span class="hljs-subst">${e.request.url}</span>?<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>)
  <span class="hljs-keyword">const</span> fetchedCopy = fetched.then(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> _.clone())

  e.respondWith(
    <span class="hljs-built_in">Promise</span>.race([fetched.catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> cached), cached])
      .then(<span class="hljs-function"><span class="hljs-params">resp</span> =&gt;</span> resp || fetched)
      .catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> fallback)
  )

  e.waitUntil(
    <span class="hljs-built_in">Promise</span>.all([fetchedCopy, caches.open(<span class="hljs-string">'runtime'</span>)])
      .then(<span class="hljs-function">(<span class="hljs-params">[resp, cache]</span>) =&gt;</span> resp.ok &amp;&amp; cache.put(e.request, resp))
      .catch(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> {<span class="hljs-comment">/* swallow */</span>})
  )
}
</code></pre>
</article></div><div style="left:78.76699029126213px;top:37.85113268608414px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>Fastest-W-Revalidate&nbsp;<span style="color:#999999">&amp;</span> Fallback</strong></h3></article></div><div style="left:126px;top:640px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p style="text-align: right;"><span style="font-size:22px"><a href="https://twitter.com/DasSurma/status/789792531005509632">@Surma</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:84.12885018545396px;top:66.59393646186099px;width:800px;height:521.977422996291px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><p><video autoplay loop src="https://huangxuan.me/sw-101-gdgdf/attach/videos/cache-then-network.m4v"><video/></p>
</article></div><div style="left:72.22689888727625px;top:600.4533139816158px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><strong>Cache then Network (from Pages)</strong></p><p><span style="font-size:22px"><a href="https://jakearchibald.com/2014/offline-cookbook/">©https://jakearchibald.com/2014/offline-cookbook/</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(35, 102, 170, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Gotcha #5</strong></h3><h2 style="text-align:left"><strong>You are IN CONTROL</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:80.12885018545396px;top:27.59393646186099px;width:800px;height:639.977422996291px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><p><video     autoplay loop src="https://huangxuan.me/pwa-qcon2016/attach/sw-update.mp4"><video/></p>
</article></div><div style="left:70.93839703273666px;top:607.0359619416222px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p>Updating the&nbsp;Service Worker</p><p><a href="https://developers.google.com/web/fundamentals/instant-and-offline/service-worker/lifecycle"><span style="font-size:18px">https://developers.google.com/web/fundamentals/instant-and-offline/service-worker/lifecycle</span></a></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:97.52750809061489px;top:150.50485436893206px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>WD 4.1.3 SkipWaiting()</strong></h3></article></div><div style="left:93px;top:284.042071197411px;width:800px;height:207.02000773442427px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>interface ServiceWorkerRegistration : EventTarget {
  <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">attribute</span> ServiceWorker? installing;
  <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">attribute</span> ServiceWorker? waiting;
  <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">attribute</span> ServiceWorker? active;
}
</code></pre>
</article></div><div style="left:79px;top:530px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="color:#FFFFFF">Override Default (</span><a href="https://developers.google.com/web/fundamentals/instant-and-offline/service-worker/lifecycle#waiting"><span style="color:#FFFFFF">Cautions</span></a><span style="color:#FFFFFF">)</span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(40, 43, 46, 1)" data-transition="none"><div style="left:93.53398058252426px;top:173.8414239482201px;width:800px;height:411.33068734607474px;" class="at-block at-block--pure"><article class="at-block-content MarkdownBlock"><pre class="hljs"><code>self.onactivate = (event) =&gt; {
  // <span class="hljs-built_in">delete</span> any caches that aren't <span class="hljs-keyword">in</span> expectedCaches
  event.waitUntil(
    caches.keys().<span class="hljs-keyword">then</span>(keys =&gt; Promise.all(
      keys.<span class="hljs-built_in">map</span>(<span class="hljs-built_in">key</span> =&gt; {
        <span class="hljs-keyword">if</span> (!expectedCaches.includes(<span class="hljs-built_in">key</span>)) {
          <span class="hljs-built_in">return</span> caches.<span class="hljs-built_in">delete</span>(<span class="hljs-built_in">key</span>);
        }
      })
    )).<span class="hljs-keyword">then</span>(console.<span class="hljs-built_in">log</span>(<span class="hljs-string">"V2 is ready!"</span>);)
  );
});
</code></pre>
</article></div><div style="left:81.58899676375404px;top:60.77669902912622px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h3><strong>On Activate</strong></h3></article></div><div style="left:94.53398058252426px;top:617.2330097087379px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:36px">Clean-up &amp; Migration.</span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(35, 102, 170, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Gotcha #6</strong></h3><h2 style="text-align:left"><strong>Architectural Revolution</strong></h2></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:63.46601941747576px;top:350.8608414239482px;width:829.7734627831716px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>RWD &nbsp; &nbsp; &nbsp;Media Query &nbsp; &nbsp; &nbsp; &nbsp;"Mobile First"</strong></h3></article></div><div style="left:61.81553398058256px;top:494.0776699029126px;width:829.7734627831716px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>PWA &nbsp; &nbsp; &nbsp;Service&nbsp;Worker &nbsp; &nbsp;"Offline First"</strong></h3></article></div><div style="left:67.93203883495148px;top:207.63754045307442px;width:829.7734627831716px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>Ajax &nbsp; &nbsp; &nbsp; XHR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;"Async First"</strong></h3></article></div><div style="left:34.91909385113272px;top:83.00970873786409px;width:864.7249190938512px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h4 style="text-align:left"><span style="color:#000000">Buzzword&nbsp; &nbsp; Core Technology&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Archtechutal Style</span></h4></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:810.1515925736672px;height:598.6120100683207px;left:76.86271504002728px;top:48.491549802229414px;" class="at-block at-block--pure"><article class="at-block-content"><img src=http://huangxuan.me/pwa-in-my-pov/attach/appshell.jpg /></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:364.85925925925926px;height:564px;left:297.57037037037037px;top:72.5px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/pwa-qcon2016/attach/installing.png /></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:1.7411003236246074px;top:121.89967637540457px;width:941.1003236245955px;height:auto0;" class="at-block at-block--pure"><article class="at-block-content"><h2><strong>Resources <span style="color:#999999">&amp;</span> Tools</strong></h2></article></div><div style="left:47.88423524345854px;top:320.78186625759434px;width:868.3594991556157px;height:auto0000;" class="at-block at-block--pure"><article class="at-block-content"><ul><li><p style="text-align:left"><a href="https://www.youtube.com/playlist?list=PLNYkxOF6rcIBTs2KPy1E6tIYaWoFcG3uj">Chrome Dev Summit 2016 [Youtube]</a></p></li><li><p><a href="https://www.youtube.com/playlist?list=PLNYkxOF6rcIAWWNR_Q6eLPhsyx6VvYjVb">Progressive Web App Summit 2016[Youtube]</a></p></li><li><p><a href="https://www.youtube.com/playlist?list=PLNYkxOF6rcIDz1TzmmMRBC-kd8zPRTQIP">Web and Chrome at Google I/O 2016[Youtube]</a></p></li><li><p style="text-align:left"><a href="https://jakearchibald.com/2014/offline-cookbook/">The Offline Cookbook (@Jake)</a>&nbsp;</p></li><li><p style="text-align:left"><a href="https://github.com/GoogleChrome/sw-precache">GoogleChrome/sw-prefetch</a></p></li><li><p style="text-align:left"><a href="https://github.com/GoogleChrome/sw-toolbox">GoogleChrome/sw-toolbox</a></p></li></ul></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="width:613.4282807731436px;height:1206px;left:168.2858596134283px;top:-529px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/pwa-qcon2016/attach/iowa.jpg /></article></div></section><section data-notes="" data-background-image="https://huangxuan.me/pwa-qcon2016/attach/surprising.gif" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:39px;top:530px;width:873px;height:auto;" class="at-block at-block--pure"><article class="at-block-content"><h1><span style="color:#FFFFFF"><strong>Visit Google in China</strong></span></h1><p><span style="color:#FFFFFF"><strong>(without bypassing GFW)</strong></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="rgba(35, 102, 170, 1)" data-transition="none"><div style="left:13.491909385113217px;top:253.02912621359224px;width:932.9741100323624px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><h3 style="text-align:left"><strong>SW 101 Gotcha #7</strong></h3><h2 style="text-align:left"><strong>The Belief In Web</strong></h2></article></div></section><section data-notes="" data-background-image="https://huangxuan.me/pwa-qcon2016/attach/oneweb.jpg" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"></section><section data-notes="" data-background-image="https://huangxuan.me/pwa-qcon2016/attach/wwdc2007.jpg" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none-in fade-out"><div style="left:68.44660194174759px;top:640.1229773462784px;width:828.4563106796116px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="color:#FFFFFF"><span style="font-size:24px"><a href="https://youtu.be/y1B2c3ZD9fk?t=1h14m48s">WWDC 2007 - The&nbsp;Innovative new way to create apps for mobile</a>&nbsp;</span></span></p></article></div><div style="left:68.44660194174759px;top:606.1229773462784px;width:828.4563106796116px;height:auto00;" class="at-block at-block--pure"><article class="at-block-content"><p><a href="http://www.apple.com/pr/library/2007/06/11iPhone-to-Support-Third-Party-Web-2-0-Applications.html"><span style="font-size:24px">iPhone to Support Third-Party Web 2.0 Applications</span></a></p></article></div></section><section data-notes="" data-background-image="https://huangxuan.me/pwa-qcon2016/attach/hux-bg.jpg" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:92.66990291262135px;top:271.6019417475728px;width:773px;height:auto00000000000;" class="at-block at-block--pure"><article class="at-block-content"><h1><span style="color:#FFFFFF"><strong>Thanks</strong></span></h1></article></div><div style="left:-0.7669902912621751px;top:619.7864077669902px;width:960.1067961165047px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:22px"><a href="http://huangxuan.me/">huangxuan.me</a>&nbsp;/&nbsp;<a href="http://weibo.com/huxpro">Weibo</a>&nbsp;/&nbsp;<a href="https://github.com/huxpro">GitHub</a>&nbsp;/&nbsp;<a href="http://www.zhihu.com/people/huxpro">知乎</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:77px;top:260px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h1><strong>Q/A</strong></h1></article></div><div style="left:72px;top:384px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:22px">自豪的采用 <a href="http://yanshuo.io">@演说.io</a></span></p></article></div><div style="left:-0.7669902912621751px;top:618.7864077669902px;width:960.1067961165047px;height:auto000;" class="at-block at-block--pure"><article class="at-block-content"><p><span style="font-size:22px"><a href="http://huangxuan.me/">huangxuan.me</a>&nbsp;/&nbsp;<a href="http://weibo.com/huxpro">Weibo</a>&nbsp;/&nbsp;<a href="https://github.com/huxpro">GitHub</a>&nbsp;/&nbsp;<a href="http://www.zhihu.com/people/huxpro">知乎</a></span></p></article></div></section><section data-notes="" data-background-video-loop="true" data-background-video-muted="true" data-background-color="" data-transition="none"><div style="left:77px;top:519px;width:800px;" class="at-block at-block--pure"><article class="at-block-content"><h4><strong><a href="https://huangxuan.me/sw-101-gdgdf/">huangxuan.me/sw-101-gdgdf</a></strong></h4><p><span style="font-size:26px"><em><a href="https://github.com/Huxpro/sw-101-gdgdf">Code @ Github/huxpro/sw-101-gdgdf&nbsp;</a></em></span></p></article></div><div style="width:396px;height:396px;left:282px;top:108px;" class="at-block at-block--pure"><article class="at-block-content"><img src=https://huangxuan.me/sw-101-gdgdf/attach/qrcode.png /></article></div></section><style>.at-block{ position:absolute }</style></div></div></div>

    <!-- dependencies -->
		<script src="https://yanshuo.io/assets/player/lib/js/head.min.js"></script>
		<script src="https://yanshuo.io/assets/player/js/reveal.min.js"></script>

    <!-- init -->
    <script>
      Reveal.initialize({
        controls: true,
        history: true,
        center: false,

        transition:             'none',
        backgroundTransition:   'none',
        transitionSpeed:        'default',

        // no marked.js
				// no markdown.js
				// no highlight.js
				dependencies: [
					{ src: 'https://yanshuo.io/assets/player/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'https://yanshuo.io/assets/player/plugin/zoom-js/zoom.js', async: true },
					{ src: 'https://yanshuo.io/assets/player/plugin/notes/notes.js', async: true }
				]
      });
    </script>
  </body>
</html>
